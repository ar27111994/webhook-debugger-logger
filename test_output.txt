
> webhook-debugger-logger@2.7.1 test
> node --experimental-vm-modules node_modules/jest/bin/jest.js

(node:48458) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
(node:48456) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
FAIL tests/ssrf_protection.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

  ● SSRF Protection Tests › /replay SSRF Protection › should reject invalid URL

    expect(received).toBe(expected) // Object.is equality

    Expected: "Invalid 'url' parameter"
    Received: "Invalid URL format"

      155 |
      156 |       expect(res.statusCode).toBe(400);
    > 157 |       expect(res.body.error).toBe("Invalid 'url' parameter");
          |                              ^
      158 |     });
      159 |
      160 |     test("should reject IPv6 loopback (::1)", async () => {

      at Object.<anonymous> (tests/ssrf_protection.test.js:157:30)

(node:48457) ExperimentalWarning: VM Modules is an experimental feature and might change at any time
(Use `node --trace-warnings ...` to show where the warning was created)
PASS tests/resilience.test.js (8.618 s)
PASS tests/stress.test.js (6.283 s)
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      Memory growth after 1000 requests: 48.48 MB

      at Object.<anonymous> (tests/stress.test.js:59:13)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/script_execution_extended.test.js
  ● Console

    console.log
      [SYSTEM] Custom script re-compiled successfully.

      at refreshCompilations (src/logger_middleware.js:468:19)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/script_execution_extended.test.js:51:11)

    console.log
      [SYSTEM] Custom script re-compiled successfully.

      at refreshCompilations (src/logger_middleware.js:468:19)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/script_execution_extended.test.js:79:11)

PASS tests/script_timeout.test.js
  ● Console

    console.log
      [SYSTEM] Custom script re-compiled successfully.

      at refreshCompilations (src/logger_middleware.js:468:19)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/script_timeout.test.js:53:11)

    console.error
      [SCRIPT-EXEC-ERROR] Failed to run custom script for wh_test_123: Script execution timed out after 1000ms

      232 |         error.code === "ERR_SCRIPT_EXECUTION_TIMEOUT" ||
      233 |         error.message?.includes("Script execution timed out");
    > 234 |       console.error(
          |               ^
      235 |         `[SCRIPT-EXEC-ERROR] Failed to run custom script for ${event.webhookId}:`,
      236 |         isTimeout
      237 |           ? `Script execution timed out after ${SCRIPT_EXECUTION_TIMEOUT_MS}ms`

      at transformRequestData (src/logger_middleware.js:234:15)
      at middleware (src/logger_middleware.js:595:7)
      at Object.<anonymous> (tests/script_timeout.test.js:53:11)

PASS tests/api.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/large_payload.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/ui.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/api_contract.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.warn
      [SECURITY] Rejecting request with unidentifiable IP: { userAgent: undefined, headers: {} }

      156 |         );
      157 |
    > 158 |         console.warn("[SECURITY] Rejecting request with unidentifiable IP:", {
          |                 ^
      159 |           userAgent: req.headers["user-agent"],
      160 |           headers: loggedHeaders,
      161 |         });

      at src/utils/rate_limiter.js:158:17
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at src/main.js:178:68
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at rawParser (node_modules/body-parser/lib/types/raw.js:67:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:91:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at compression (node_modules/compression/index.js:243:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at Function.handle (node_modules/express/lib/application.js:181:10)
      at Server.app (node_modules/express/lib/express.js:39:9)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/production_ready.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/main.routes.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/edge_cases.test.js (12.883 s)
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.warn
      [SECURITY] Rejecting request with unidentifiable IP: { userAgent: undefined, headers: {} }

      156 |         );
      157 |
    > 158 |         console.warn("[SECURITY] Rejecting request with unidentifiable IP:", {
          |                 ^
      159 |           userAgent: req.headers["user-agent"],
      160 |           headers: loggedHeaders,
      161 |         });

      at src/utils/rate_limiter.js:158:17
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at src/main.js:178:68
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at rawParser (node_modules/body-parser/lib/types/raw.js:67:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:91:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at compression (node_modules/compression/index.js:243:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at Function.handle (node_modules/express/lib/application.js:181:10)
      at Server.app (node_modules/express/lib/express.js:39:9)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/middleware.test.js
  ● Console

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/middleware.test.js:56:11)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/middleware.test.js:84:11)

    console.log
      [SYSTEM] JSON Schema re-compiled successfully.

      at refreshCompilations (src/logger_middleware.js:498:19)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/middleware.test.js:101:11)

    console.log
      [SYSTEM] Custom script re-compiled successfully.

      at refreshCompilations (src/logger_middleware.js:468:19)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/middleware.test.js:117:11)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/middleware.test.js:136:11)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/middleware.test.js:153:11)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/middleware.test.js:175:11)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at validateWebhookRequest (src/logger_middleware.js:105:5)
      at middleware (src/logger_middleware.js:546:24)
      at Object.<anonymous> (tests/middleware.test.js:193:11)

PASS tests/hot_reload.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 1 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 1 of 1 webhooks to 1h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      [SYSTEM] Detected input update! Applying new settings...

      at src/main.js:208:13

    console.log
      [STORAGE] Extended retention for 1 of 1 webhooks to 1h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      [SYSTEM] Hot-reload complete. New settings are active.

      at src/main.js:244:15

    console.log
      [SYSTEM] Detected input update! Applying new settings...

      at src/main.js:208:13

    console.log
      [SYSTEM] Dynamic Scale-up: Generating 2 additional webhook(s).

      at src/main.js:234:17

    console.log
      [STORAGE] Extended retention for 1 of 3 webhooks to 1h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      [SYSTEM] Hot-reload complete. New settings are active.

      at src/main.js:244:15

    console.log
      [SYSTEM] Detected input update! Applying new settings...

      at src/main.js:208:13

    console.log
      [SYSTEM] Custom script re-compiled successfully.

      at refreshCompilations (src/logger_middleware.js:468:19)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 1h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      [SYSTEM] Hot-reload complete. New settings are active.

      at src/main.js:244:15

    console.log
      [SYSTEM] Detected input update! Applying new settings...

      at src/main.js:208:13

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 1h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      [SYSTEM] Hot-reload complete. New settings are active.

      at src/main.js:244:15

PASS tests/forwarding.test.js
  ● Console

    console.error
      [FORWARD-ERROR] Attempt 1/3 failed for http://target.com/ingest: Timed out

      371 |             const delay = 1000 * Math.pow(2, attempt - 1);
      372 |
    > 373 |             console.error(
          |                     ^
      374 |               `[FORWARD-ERROR] Attempt ${attempt}/${MAX_FORWARD_RETRIES} failed for ${validatedUrl}:`,
      375 |               axiosError.code === "ECONNABORTED"
      376 |                 ? "Timed out"

      at src/logger_middleware.js:373:21
      at executeBackgroundTasks (src/logger_middleware.js:410:7)
      at backgroundPromise (src/logger_middleware.js:611:11)
      at middleware (src/logger_middleware.js:627:7)

    console.error
      [FORWARD-ERROR] Attempt 2/3 failed for http://target.com/ingest: Timed out

      371 |             const delay = 1000 * Math.pow(2, attempt - 1);
      372 |
    > 373 |             console.error(
          |                     ^
      374 |               `[FORWARD-ERROR] Attempt ${attempt}/${MAX_FORWARD_RETRIES} failed for ${validatedUrl}:`,
      375 |               axiosError.code === "ECONNABORTED"
      376 |                 ? "Timed out"

      at src/logger_middleware.js:373:21
      at executeBackgroundTasks (src/logger_middleware.js:410:7)
      at backgroundPromise (src/logger_middleware.js:611:11)

    console.error
      [FORWARD-ERROR] Attempt 3/3 failed for http://target.com/ingest: Timed out

      371 |             const delay = 1000 * Math.pow(2, attempt - 1);
      372 |
    > 373 |             console.error(
          |                     ^
      374 |               `[FORWARD-ERROR] Attempt ${attempt}/${MAX_FORWARD_RETRIES} failed for ${validatedUrl}:`,
      375 |               axiosError.code === "ECONNABORTED"
      376 |                 ? "Timed out"

      at src/logger_middleware.js:373:21
      at executeBackgroundTasks (src/logger_middleware.js:410:7)
      at backgroundPromise (src/logger_middleware.js:611:11)

    console.error
      [FORWARD-ERROR] Attempt 1/3 failed for http://target.com/ingest: Bad Request

      371 |             const delay = 1000 * Math.pow(2, attempt - 1);
      372 |
    > 373 |             console.error(
          |                     ^
      374 |               `[FORWARD-ERROR] Attempt ${attempt}/${MAX_FORWARD_RETRIES} failed for ${validatedUrl}:`,
      375 |               axiosError.code === "ECONNABORTED"
      376 |                 ? "Timed out"

      at src/logger_middleware.js:373:21
      at executeBackgroundTasks (src/logger_middleware.js:410:7)
      at backgroundPromise (src/logger_middleware.js:611:11)
      at middleware (src/logger_middleware.js:627:7)
      at Object.<anonymous> (tests/forwarding.test.js:224:7)

    console.warn
      [ADVICE] Check your Apify platform limits or storage availability.

      426 |
      427 |     if (isPlatformError) {
    > 428 |       console.warn(
          |               ^
      429 |         "[ADVICE] Check your Apify platform limits or storage availability.",
      430 |       );
      431 |     }

      at executeBackgroundTasks (src/logger_middleware.js:428:15)
      at backgroundPromise (src/logger_middleware.js:611:11)
      at middleware (src/logger_middleware.js:627:7)
      at Object.<anonymous> (tests/forwarding.test.js:254:7)

PASS tests/webhook_lifecycle.test.js
  ● Console

    console.log
      [STORAGE] Restored 1 webhooks from state.

      at WebhookManager.init (src/webhook_manager.js:28:17)

    console.log
      [SYSTEM] Scaling up: Generating 2 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 1h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      [STORAGE] Restored 3 webhooks from state.

      at WebhookManager.init (src/webhook_manager.js:28:17)

    console.log
      [SYSTEM] Notice: Active webhooks (3) exceed requested count (1). No new IDs generated.

      at initialize (src/main.js:160:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 1h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      [STORAGE] Restored 1 webhooks from state.

      at WebhookManager.init (src/webhook_manager.js:28:17)

    console.log
      [SYSTEM] Resuming with 1 active webhooks.

      at initialize (src/main.js:164:13)

    console.log
      [STORAGE] Extended retention for 1 of 1 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

PASS tests/concurrency.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 3 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 3 of 3 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/auth_ui.test.js
  ● Console

    console.log
      [SYSTEM] Scaling up: Generating 1 additional webhook(s).

      at initialize (src/main.js:155:13)

    console.log
      [STORAGE] Extended retention for 1 of 1 webhooks to 24h.

      at WebhookManager.updateRetention (src/webhook_manager.js:176:15)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at src/main.js:586:7
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at src/main.js:178:68
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at rawParser (node_modules/body-parser/lib/types/raw.js:67:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:91:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at compression (node_modules/compression/index.js:243:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at Function.handle (node_modules/express/lib/application.js:181:10)
      at Server.app (node_modules/express/lib/express.js:39:9)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at authMiddleware (src/main.js:271:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at src/utils/rate_limiter.js:206:7
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at src/main.js:178:68
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at rawParser (node_modules/body-parser/lib/types/raw.js:67:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:91:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at compression (node_modules/compression/index.js:243:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at Function.handle (node_modules/express/lib/application.js:181:10)
      at Server.app (node_modules/express/lib/express.js:39:9)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at authMiddleware (src/main.js:271:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at src/utils/rate_limiter.js:206:7
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at src/main.js:178:68
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at rawParser (node_modules/body-parser/lib/types/raw.js:67:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:91:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at compression (node_modules/compression/index.js:243:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at Function.handle (node_modules/express/lib/application.js:181:10)
      at Server.app (node_modules/express/lib/express.js:39:9)

    console.warn
      [SECURITY] API key provided in query string. Use Authorization header instead.

      22 |     // 2. Fallback to query param (Deprecated/Riskier)
      23 |     providedKey = req.query.key;
    > 24 |     console.warn(
         |             ^
      25 |       "[SECURITY] API key provided in query string. Use Authorization header instead.",
      26 |     );
      27 |   }

      at validateAuth (src/utils/auth.js:24:13)
      at src/main.js:586:7
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at next (node_modules/express/lib/router/route.js:149:13)
      at Route.dispatch (node_modules/express/lib/router/route.js:119:3)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at node_modules/express/lib/router/index.js:284:15
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at src/main.js:178:68
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at rawParser (node_modules/body-parser/lib/types/raw.js:67:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at urlencodedParser (node_modules/body-parser/lib/types/urlencoded.js:91:7)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at compression (node_modules/compression/index.js:243:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at expressInit (node_modules/express/lib/middleware/init.js:40:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at query (node_modules/express/lib/middleware/query.js:45:5)
      at Layer.handle [as handle_request] (node_modules/express/lib/router/layer.js:95:5)
      at trim_prefix (node_modules/express/lib/router/index.js:328:13)
      at node_modules/express/lib/router/index.js:286:9
      at Function.process_params (node_modules/express/lib/router/index.js:346:12)
      at next (node_modules/express/lib/router/index.js:280:10)
      at Function.handle (node_modules/express/lib/router/index.js:175:3)
      at Function.handle (node_modules/express/lib/application.js:181:10)
      at Server.app (node_modules/express/lib/express.js:39:9)

    console.log
      Received TEST_COMPLETE. Shutting down...

      at shutdown (src/main.js:86:11)

PASS tests/webhook_manager.test.js
  ● Console

    console.log
      [STORAGE] Restored 1 webhooks from state.

      at WebhookManager.init (src/webhook_manager.js:28:17)

    console.error
      [CRITICAL] Failed to initialize WebhookManager state: Storage failure

      35 |           ? error.message
      36 |           : String(error ?? "Unknown error");
    > 37 |       console.error(
         |               ^
      38 |         "[CRITICAL] Failed to initialize WebhookManager state:",
      39 |         message,
      40 |       );

      at WebhookManager.init (src/webhook_manager.js:37:15)
      at Object.<anonymous> (tests/webhook_manager.test.js:45:5)

    console.error
      [STORAGE-ERROR] Failed to persist webhook state: Write failure

      54 |           ? error.message
      55 |           : String(error ?? "Unknown error");
    > 56 |       console.error(
         |               ^
      57 |         "[STORAGE-ERROR] Failed to persist webhook state:",
      58 |         message,
      59 |       );

      at WebhookManager.persist (src/webhook_manager.js:56:15)
      at Object.<anonymous> (tests/webhook_manager.test.js:141:5)

    console.error
      [STORAGE-ERROR] Failed to persist webhook state: String error

      54 |           ? error.message
      55 |           : String(error ?? "Unknown error");
    > 56 |       console.error(
         |               ^
      57 |         "[STORAGE-ERROR] Failed to persist webhook state:",
      58 |         message,
      59 |       );

      at WebhookManager.persist (src/webhook_manager.js:56:15)
      at Object.<anonymous> (tests/webhook_manager.test.js:152:5)

PASS tests/rate_limiter.test.js

Test Suites: 1 failed, 19 passed, 20 total
Tests:       1 failed, 120 passed, 121 total
Snapshots:   0 total
Time:        16.526 s
Ran all test suites.
